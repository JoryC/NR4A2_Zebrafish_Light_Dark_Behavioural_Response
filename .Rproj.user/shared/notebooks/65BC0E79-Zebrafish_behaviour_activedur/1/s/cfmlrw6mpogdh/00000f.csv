"0","cycle_filter <- c(""Light"", ""Dark"")"
"0",""
"0","GenotypeNames <- c(""WT"", ""KO A"", ""KO B"")"
"0",""
"0","dun_list <- NULL"
"0","dun_list_2 <- NULL"
"0","for (j in 1) {"
"0","  for (i in 1:2) {"
"0","    temp <- fishBehavDatBinLD %>%"
"0","      filter(Cycle != ""Acclimation"") %>%"
"0","      select(-Subtype) %>%"
"0","      group_by(Cycle, Genotype) %>%"
"0","      na.omit() %>%"
"0","      as.data.frame() %>%"
"0","      filter(Cycle == cycle_filter[i]) # 2 cycles in total - Light & Dark"
"0","    temp_dun <- DunnettTest(get(params$value) ~ Genotype, data = temp, control = ""WT"")"
"0","    # temp_dun$Control[,4] <- p.adjust(temp_dun$Control[,4], method = ""fdr"") "
"0","    # new_row <- matrix(data = c(NA,NA,NA,NA), nrow = 1, ncol = 4)"
"0","    # row.names(new_row) <- ""Control-Control"""
"0","    # colnames(new_row) <- c(""diff"", ""lwr.ci"", ""upr.ci"", ""pval"")"
"0","    "
"0","    dun_list[[cycle_filter[i]]] <- temp_dun[[1]] %>% "
"0","      as.data.frame() %>%"
"0","      # rbind(new_row) %>%"
"0","      rownames_to_column(var = ""Genotype"")"
"0","    "
"0","  }"
"0","  dun_list_2[[GenotypeNames[j]]] <- ldply(dun_list, .id = ""Cycle"")"
"0","  dun_list_2[[j]]$pval <- p.adjust(dun_list_2[[j]]$pval, method = ""fdr"") # p value adjustment https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6099145/ (for single test - same samples)"
"0","  "
"0","  new_row <- as.data.frame(matrix(data = c(""Light"", ""WT-WT"", NA, NA, NA, 1,"
"0","                           ""Dark"", ""WT-WT"", NA, NA, NA, 1),"
"0","                  nrow = 2, ncol = 6, byrow = TRUE))"
"0","  colnames(new_row) <- c(""Cycle"", ""Genotype"", ""diff"", ""lwr.ci"", ""upr.ci"", ""pval"")"
"0","  new_row$pval <- as.numeric(new_row$pval)"
"0",""
"0","  dun_list_2[[j]] <- dun_list_2[[j]] %>%"
"0","    rbind(new_row)"
"0","}"
"0",""
"0","dunnett_binned <- ldply(dun_list_2, .id = ""Genotype"")"
"0",""
"0","dunnett_binned$Genotype = str_split(string = dunnett_binned$Genotype, pattern = ""-"", simplify = T)[,1] #Here we are fixing the dose column... the dose column has the test dose related to the control... but we just want to see what the test dose is without it giving us redundant information about the comparison to the control for every observation..."
